<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="eqlee.ctm.finance.settlement.dao.InFinanceMapper">

    <select id="queryOrderNumber" parameterType="long" resultType="eqlee.ctm.finance.settlement.entity.vo.OrderDetailedVo">
        select a.AdultNumber, a.BabyNumber, a.OldNumber, a.ChildNumber from OrderDetailed a join Orders b on a.OrderId = b.Id
        where  a.PayType = 2 and b.CreateUserId = #{Id}
    </select>


    <select id="listExamine2Page" resultType="eqlee.ctm.finance.settlement.entity.query.ExamineResultQuery">
        select a.Id, a.GuideName,convert(char(10),a.OutDate,120) as 'OutDate',a.LineName,c.Tel,(a.SettlementPrice - b.AllOutPrice) as 'InPrice',
        (a.SubstitutionPrice - b.AllOutPrice) as 'FinallyPrice',b.AllOutPrice from Income a join Outcome b
        on a.Id = b.IncomeId join SystemUser c on a.CreateUserId = c.Id
    </select>

    <select id="listExamineDetailed" parameterType="long" resultType="eqlee.ctm.finance.settlement.entity.vo.ExamineResultVo">
        select a.GuideName,convert(char(10),a.OutDate,120) as 'OutDate',a.LineName,a.SettlementPrice,a.substitutionPrice,b.TicketName,
        b.TicketPrice,b.LunchPrice,b.ParkingRatePrice,b.CarNo,b.RentCarPrice,b.GuideSubsidy,b.DriverSubsidy,b.AllOutPrice,
        (a.SettlementPrice - b.AllOutPrice) as 'InPrice',(a.SubstitutionPrice - b.AllOutPrice) as 'FinallyPrice',c.AllDoNumber,
        c.TrueAllNumber,c.TreeAdultNumber,c.TreeBabyNumber,c.TreeOldNumber,c.TreeChildNumber,c.UnpaidNumber,d.ContectUserName,
        d.ContectUserTel,d.AllNumber,d.AllPrice,d.BabyNumber,d.OldNumber,d.ChildNumber,d.AdultNumber
        from Income a join OutCome b on a.Id = b.IncomeId join Number c on a.NumberId = c.Id join NumberDetailed d on c.Id = d.NumberId
        where a.Id = #{Id}
    </select>
</mapper>